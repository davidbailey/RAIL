"""
Tests for the Vulnerability and Vulnerabilities classes
"""
import unittest

from rail import (
    Control,
    ThreatEvent,
    ThreatSources,
    Tree,
    Vulnerability,
    Vulnerabilities,
)


class TestVulnerabilities(unittest.TestCase):
    """
    Class to test a Vulnerability
    """

    def setUp(self):
        self.vulnerabilities = Vulnerabilities()
        self.threat_sources = ThreatSources()
        self.threat_sources.new("test")
        self.threat_event = ThreatEvent("test event", self.threat_sources["test"])
        self.system = Tree(name="test tree")
        self.controls = [Control("test control", 100, 0.1)]
        self.vulnerabilities.new(self.threat_event, self.system, self.controls)

    def test_vulnerabilities(self):
        """
        Test vulnerabilities
        """
        name = (
            self.threat_event["name"]
            + " -> "
            + self.system.path()
            + " | "
            + str(self.controls)
        )
        self.assertEqual(self.vulnerabilities[name]["threat_event"], self.threat_event)
        self.assertEqual(self.vulnerabilities[name]["system"], self.system)
        self.assertEqual(self.vulnerabilities[name]["controls"], self.controls)


if __name__ == "__main__":
    unittest.main()
